'use strict';

const fs = require('fs');
const shebangCommand = require('shebang-command');

function readShebang(command) ***REMOVED***
    // Read the first 150 bytes from the file
    const size = 150;
    let buffer;

    if (Buffer.alloc) ***REMOVED***
        // Node.js v4.5+ / v5.10+
        buffer = Buffer.alloc(size);
    ***REMOVED*** else ***REMOVED***
        // Old Node.js API
        buffer = new Buffer(size);
        buffer.fill(0); // zero-fill
    ***REMOVED***

    let fd;

    try ***REMOVED***
        fd = fs.openSync(command, 'r');
        fs.readSync(fd, buffer, 0, size, 0);
        fs.closeSync(fd);
    ***REMOVED*** catch (e) ***REMOVED*** /* Empty */ ***REMOVED***

    // Attempt to extract shebang (null is returned if not a shebang)
    return shebangCommand(buffer.toString());
***REMOVED***

module.exports = readShebang;
