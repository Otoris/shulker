import ***REMOVED*** Operator ***REMOVED*** from '../Operator';
import ***REMOVED*** Subscriber ***REMOVED*** from '../Subscriber';
import ***REMOVED*** Observable ***REMOVED*** from '../Observable';
import ***REMOVED*** SubscribeOnObservable ***REMOVED*** from '../observable/SubscribeOnObservable';
import ***REMOVED*** MonoTypeOperatorFunction, SchedulerLike, TeardownLogic ***REMOVED*** from '../types';

/**
 * Asynchronously subscribes Observers to this Observable on the specified ***REMOVED***@link SchedulerLike***REMOVED***.
 *
 * With `subscribeOn` you can decide what type of scheduler a specific Observable will be using when it is subscribed to.
 *
 * Schedulers control the speed and order of emissions to observers from an Observable stream.
 *
 * ![](subscribeOn.png)
 *
 * ## Example
 * Given the following code:
 * ```javascript
 * import ***REMOVED*** of, merge ***REMOVED*** from 'rxjs';
 *
 * const a = of(1, 2, 3, 4);
 * const b = of(5, 6, 7, 8, 9);
 * merge(a, b).subscribe(console.log);
 * ```
 *
 * Both Observable `a` and `b` will emit their values directly and synchronously once they are subscribed to.
 * This will result in the output of `1 2 3 4 5 6 7 8 9`.
 *
 * But if we instead us the `subscribeOn` operator declaring that we want to use the ***REMOVED***@link asyncScheduler***REMOVED*** for values emited by Observable `a`:
 * ```javascript
 * import ***REMOVED*** of, merge, asyncScheduler ***REMOVED*** from 'rxjs';
 * import ***REMOVED*** subscribeOn ***REMOVED*** from 'rxjs/operators';
 *
 * const a = of(1, 2, 3, 4).pipe(subscribeOn(asyncScheduler));
 * const b = of(5, 6, 7, 8, 9);
 * merge(a, b).subscribe(console.log);
 * ```
 *
 * The output will instead be `5 6 7 8 9 1 2 3 4`.
 * The reason for this is that Observable `b` emits its values directly and synchronously like before
 * but the emissions from `a` are scheduled on the event loop because we are now using the ***REMOVED***@link asyncScheduler***REMOVED*** for that specific Observable.
 *
 * @param ***REMOVED***SchedulerLike***REMOVED*** scheduler - The ***REMOVED***@link SchedulerLike***REMOVED*** to perform subscription actions on.
 * @return ***REMOVED***Observable<T>***REMOVED*** The source Observable modified so that its subscriptions happen on the specified ***REMOVED***@link SchedulerLike***REMOVED***.
 .
 * @method subscribeOn
 * @owner Observable
 */
export function subscribeOn<T>(scheduler: SchedulerLike, delay: number = 0): MonoTypeOperatorFunction<T> ***REMOVED***
  return function subscribeOnOperatorFunction(source: Observable<T>): Observable<T> ***REMOVED***
    return source.lift(new SubscribeOnOperator<T>(scheduler, delay));
  ***REMOVED***;
***REMOVED***

class SubscribeOnOperator<T> implements Operator<T, T> ***REMOVED***
  constructor(private scheduler: SchedulerLike,
              private delay: number) ***REMOVED***
  ***REMOVED***
  call(subscriber: Subscriber<T>, source: any): TeardownLogic ***REMOVED***
    return new SubscribeOnObservable<T>(
      source, this.delay, this.scheduler
    ).subscribe(subscriber);
  ***REMOVED***
***REMOVED***
