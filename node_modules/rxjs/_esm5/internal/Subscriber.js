/** PURE_IMPORTS_START tslib,_util_isFunction,_Observer,_Subscription,_internal_symbol_rxSubscriber,_config,_util_hostReportError PURE_IMPORTS_END */
import * as tslib_1 from "tslib";
import ***REMOVED*** isFunction ***REMOVED*** from './util/isFunction';
import ***REMOVED*** empty as emptyObserver ***REMOVED*** from './Observer';
import ***REMOVED*** Subscription ***REMOVED*** from './Subscription';
import ***REMOVED*** rxSubscriber as rxSubscriberSymbol ***REMOVED*** from '../internal/symbol/rxSubscriber';
import ***REMOVED*** config ***REMOVED*** from './config';
import ***REMOVED*** hostReportError ***REMOVED*** from './util/hostReportError';
var Subscriber = /*@__PURE__*/ (function (_super) ***REMOVED***
    tslib_1.__extends(Subscriber, _super);
    function Subscriber(destinationOrNext, error, complete) ***REMOVED***
        var _this = _super.call(this) || this;
        _this.syncErrorValue = null;
        _this.syncErrorThrown = false;
        _this.syncErrorThrowable = false;
        _this.isStopped = false;
        switch (arguments.length) ***REMOVED***
            case 0:
                _this.destination = emptyObserver;
                break;
            case 1:
                if (!destinationOrNext) ***REMOVED***
                    _this.destination = emptyObserver;
                    break;
                ***REMOVED***
                if (typeof destinationOrNext === 'object') ***REMOVED***
                    if (destinationOrNext instanceof Subscriber) ***REMOVED***
                        _this.syncErrorThrowable = destinationOrNext.syncErrorThrowable;
                        _this.destination = destinationOrNext;
                        destinationOrNext.add(_this);
                    ***REMOVED***
                    else ***REMOVED***
                        _this.syncErrorThrowable = true;
                        _this.destination = new SafeSubscriber(_this, destinationOrNext);
                    ***REMOVED***
                    break;
                ***REMOVED***
            default:
                _this.syncErrorThrowable = true;
                _this.destination = new SafeSubscriber(_this, destinationOrNext, error, complete);
                break;
        ***REMOVED***
        return _this;
    ***REMOVED***
    Subscriber.prototype[rxSubscriberSymbol] = function () ***REMOVED*** return this; ***REMOVED***;
    Subscriber.create = function (next, error, complete) ***REMOVED***
        var subscriber = new Subscriber(next, error, complete);
        subscriber.syncErrorThrowable = false;
        return subscriber;
    ***REMOVED***;
    Subscriber.prototype.next = function (value) ***REMOVED***
        if (!this.isStopped) ***REMOVED***
            this._next(value);
        ***REMOVED***
    ***REMOVED***;
    Subscriber.prototype.error = function (err) ***REMOVED***
        if (!this.isStopped) ***REMOVED***
            this.isStopped = true;
            this._error(err);
        ***REMOVED***
    ***REMOVED***;
    Subscriber.prototype.complete = function () ***REMOVED***
        if (!this.isStopped) ***REMOVED***
            this.isStopped = true;
            this._complete();
        ***REMOVED***
    ***REMOVED***;
    Subscriber.prototype.unsubscribe = function () ***REMOVED***
        if (this.closed) ***REMOVED***
            return;
        ***REMOVED***
        this.isStopped = true;
        _super.prototype.unsubscribe.call(this);
    ***REMOVED***;
    Subscriber.prototype._next = function (value) ***REMOVED***
        this.destination.next(value);
    ***REMOVED***;
    Subscriber.prototype._error = function (err) ***REMOVED***
        this.destination.error(err);
        this.unsubscribe();
    ***REMOVED***;
    Subscriber.prototype._complete = function () ***REMOVED***
        this.destination.complete();
        this.unsubscribe();
    ***REMOVED***;
    Subscriber.prototype._unsubscribeAndRecycle = function () ***REMOVED***
        var _parentOrParents = this._parentOrParents;
        this._parentOrParents = null;
        this.unsubscribe();
        this.closed = false;
        this.isStopped = false;
        this._parentOrParents = _parentOrParents;
        return this;
    ***REMOVED***;
    return Subscriber;
***REMOVED***(Subscription));
export ***REMOVED*** Subscriber ***REMOVED***;
var SafeSubscriber = /*@__PURE__*/ (function (_super) ***REMOVED***
    tslib_1.__extends(SafeSubscriber, _super);
    function SafeSubscriber(_parentSubscriber, observerOrNext, error, complete) ***REMOVED***
        var _this = _super.call(this) || this;
        _this._parentSubscriber = _parentSubscriber;
        var next;
        var context = _this;
        if (isFunction(observerOrNext)) ***REMOVED***
            next = observerOrNext;
        ***REMOVED***
        else if (observerOrNext) ***REMOVED***
            next = observerOrNext.next;
            error = observerOrNext.error;
            complete = observerOrNext.complete;
            if (observerOrNext !== emptyObserver) ***REMOVED***
                context = Object.create(observerOrNext);
                if (isFunction(context.unsubscribe)) ***REMOVED***
                    _this.add(context.unsubscribe.bind(context));
                ***REMOVED***
                context.unsubscribe = _this.unsubscribe.bind(_this);
            ***REMOVED***
        ***REMOVED***
        _this._context = context;
        _this._next = next;
        _this._error = error;
        _this._complete = complete;
        return _this;
    ***REMOVED***
    SafeSubscriber.prototype.next = function (value) ***REMOVED***
        if (!this.isStopped && this._next) ***REMOVED***
            var _parentSubscriber = this._parentSubscriber;
            if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) ***REMOVED***
                this.__tryOrUnsub(this._next, value);
            ***REMOVED***
            else if (this.__tryOrSetError(_parentSubscriber, this._next, value)) ***REMOVED***
                this.unsubscribe();
            ***REMOVED***
        ***REMOVED***
    ***REMOVED***;
    SafeSubscriber.prototype.error = function (err) ***REMOVED***
        if (!this.isStopped) ***REMOVED***
            var _parentSubscriber = this._parentSubscriber;
            var useDeprecatedSynchronousErrorHandling = config.useDeprecatedSynchronousErrorHandling;
            if (this._error) ***REMOVED***
                if (!useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) ***REMOVED***
                    this.__tryOrUnsub(this._error, err);
                    this.unsubscribe();
                ***REMOVED***
                else ***REMOVED***
                    this.__tryOrSetError(_parentSubscriber, this._error, err);
                    this.unsubscribe();
                ***REMOVED***
            ***REMOVED***
            else if (!_parentSubscriber.syncErrorThrowable) ***REMOVED***
                this.unsubscribe();
                if (useDeprecatedSynchronousErrorHandling) ***REMOVED***
                    throw err;
                ***REMOVED***
                hostReportError(err);
            ***REMOVED***
            else ***REMOVED***
                if (useDeprecatedSynchronousErrorHandling) ***REMOVED***
                    _parentSubscriber.syncErrorValue = err;
                    _parentSubscriber.syncErrorThrown = true;
                ***REMOVED***
                else ***REMOVED***
                    hostReportError(err);
                ***REMOVED***
                this.unsubscribe();
            ***REMOVED***
        ***REMOVED***
    ***REMOVED***;
    SafeSubscriber.prototype.complete = function () ***REMOVED***
        var _this = this;
        if (!this.isStopped) ***REMOVED***
            var _parentSubscriber = this._parentSubscriber;
            if (this._complete) ***REMOVED***
                var wrappedComplete = function () ***REMOVED*** return _this._complete.call(_this._context); ***REMOVED***;
                if (!config.useDeprecatedSynchronousErrorHandling || !_parentSubscriber.syncErrorThrowable) ***REMOVED***
                    this.__tryOrUnsub(wrappedComplete);
                    this.unsubscribe();
                ***REMOVED***
                else ***REMOVED***
                    this.__tryOrSetError(_parentSubscriber, wrappedComplete);
                    this.unsubscribe();
                ***REMOVED***
            ***REMOVED***
            else ***REMOVED***
                this.unsubscribe();
            ***REMOVED***
        ***REMOVED***
    ***REMOVED***;
    SafeSubscriber.prototype.__tryOrUnsub = function (fn, value) ***REMOVED***
        try ***REMOVED***
            fn.call(this._context, value);
        ***REMOVED***
        catch (err) ***REMOVED***
            this.unsubscribe();
            if (config.useDeprecatedSynchronousErrorHandling) ***REMOVED***
                throw err;
            ***REMOVED***
            else ***REMOVED***
                hostReportError(err);
            ***REMOVED***
        ***REMOVED***
    ***REMOVED***;
    SafeSubscriber.prototype.__tryOrSetError = function (parent, fn, value) ***REMOVED***
        if (!config.useDeprecatedSynchronousErrorHandling) ***REMOVED***
            throw new Error('bad call');
        ***REMOVED***
        try ***REMOVED***
            fn.call(this._context, value);
        ***REMOVED***
        catch (err) ***REMOVED***
            if (config.useDeprecatedSynchronousErrorHandling) ***REMOVED***
                parent.syncErrorValue = err;
                parent.syncErrorThrown = true;
                return true;
            ***REMOVED***
            else ***REMOVED***
                hostReportError(err);
                return true;
            ***REMOVED***
        ***REMOVED***
        return false;
    ***REMOVED***;
    SafeSubscriber.prototype._unsubscribe = function () ***REMOVED***
        var _parentSubscriber = this._parentSubscriber;
        this._context = null;
        this._parentSubscriber = null;
        _parentSubscriber.unsubscribe();
    ***REMOVED***;
    return SafeSubscriber;
***REMOVED***(Subscriber));
export ***REMOVED*** SafeSubscriber ***REMOVED***;
//# sourceMappingURL=Subscriber.js.map
