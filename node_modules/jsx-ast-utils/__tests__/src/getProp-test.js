/* eslint-env mocha */
import assert from 'assert';
import ***REMOVED*** getOpeningElement, setParserName ***REMOVED*** from '../helper';
import getProp from '../../src/getProp';

describe('getProp', () => ***REMOVED***
  beforeEach(() => ***REMOVED***
    setParserName('babel');
  ***REMOVED***);
  it('should export a function', () => ***REMOVED***
    const expected = 'function';
    const actual = typeof getProp;

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should return undefined if no arguments are provided', () => ***REMOVED***
    const expected = undefined;
    const actual = getProp();

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should return undefined if the attribute is absent', () => ***REMOVED***
    const code = '<div />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'id';

    const expected = undefined;
    const actual = getProp(props, prop);

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should return the correct attribute if the attribute exists', () => ***REMOVED***
    const code = '<div id="foo" />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'id';

    const expected = 'id';
    const actual = getProp(props, prop).name.name;

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should return the correct attribute if the attribute exists in spread', () => ***REMOVED***
    const code = '<div ***REMOVED***...***REMOVED*** id: "foo" ***REMOVED******REMOVED*** />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'ID';

    const expected = 'id';
    const actual = getProp(props, prop).name.name;

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should return the correct attribute if the attribute exists in spread as an expression', () => ***REMOVED***
    const code = '<div ***REMOVED***...***REMOVED*** id ***REMOVED******REMOVED*** />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'id';

    const expected = 'id';
    const actual = getProp(props, prop);
    const actualName = actual.name.name;
    const actualValue = actual.value.expression.name;

    assert.equal(expected, actualName);
    assert.equal(expected, actualValue);
  ***REMOVED***);

  it('should return the correct attribute if the attribute exists in spread (case sensitive)', () => ***REMOVED***
    const code = '<div ***REMOVED***...***REMOVED*** id: "foo" ***REMOVED******REMOVED*** />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'id';
    const options = ***REMOVED*** ignoreCase: false ***REMOVED***;

    const expected = 'id';
    const actual = getProp(props, prop, options).name.name;

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should return undefined if the attribute does not exist in spread (case sensitive)', () => ***REMOVED***
    const code = '<div ***REMOVED***...***REMOVED*** id: "foo" ***REMOVED******REMOVED*** />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'ID';
    const options = ***REMOVED*** ignoreCase: false ***REMOVED***;

    const expected = undefined;
    const actual = getProp(props, prop, options);

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should return undefined for key in spread', () => ***REMOVED***
    // https://github.com/reactjs/rfcs/pull/107
    const code = '<div ***REMOVED***...***REMOVED*** key ***REMOVED******REMOVED*** />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'key';

    const expected = undefined;
    const actual = getProp(props, prop);

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should return undefined if the attribute may exist in spread', () => ***REMOVED***
    const code = '<div ***REMOVED***...props***REMOVED*** />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'id';

    const expected = undefined;
    const actual = getProp(props, prop);

    assert.equal(expected, actual);
  ***REMOVED***);

  it('should not crash if the spread contains a spread', () => ***REMOVED***
    const code = '<div ***REMOVED***...***REMOVED*** ...props ***REMOVED******REMOVED*** />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'id';

    getProp(props, prop);
  ***REMOVED***);

  it('should return undefined if the attribute is considered absent in case-sensitive mode', () => ***REMOVED***
    const code = '<div ID="foo" />';
    const node = getOpeningElement(code);
    const ***REMOVED*** attributes: props ***REMOVED*** = node;
    const prop = 'id';
    const options = ***REMOVED***
      ignoreCase: false,
    ***REMOVED***;

    const expected = undefined;
    const actual = getProp(props, prop, options);

    assert.equal(expected, actual);
  ***REMOVED***);
***REMOVED***);
