const Action = require('./Action');

class MessageDeleteAction extends Action ***REMOVED***
  constructor(client) ***REMOVED***
    super(client);
    this.deleted = new Map();
  ***REMOVED***

  handle(data) ***REMOVED***
    const client = this.client;
    const channel = client.channels.get(data.channel_id);
    let message;

    if (channel) ***REMOVED***
      message = channel.messages.get(data.id);
      if (message) ***REMOVED***
        channel.messages.delete(message.id);
        this.deleted.set(channel.id + message.id, message);
        this.scheduleForDeletion(channel.id, message.id);
      ***REMOVED*** else ***REMOVED***
        message = this.deleted.get(channel.id + data.id) || null;
      ***REMOVED***
      if (message) message.deleted = true;
    ***REMOVED***

    return ***REMOVED*** message ***REMOVED***;
  ***REMOVED***

  scheduleForDeletion(channelID, messageID) ***REMOVED***
    this.client.setTimeout(() => this.deleted.delete(channelID + messageID),
      this.client.options.restWsBridgeTimeout);
  ***REMOVED***
***REMOVED***

module.exports = MessageDeleteAction;
