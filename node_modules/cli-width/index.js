'use strict';

exports = module.exports = cliWidth;

function normalizeOpts(options) ***REMOVED***
  var defaultOpts = ***REMOVED***
    defaultWidth: 0,
    output: process.stdout,
    tty: require('tty')
  ***REMOVED***;

  if (!options) ***REMOVED***
    return defaultOpts;
  ***REMOVED*** else ***REMOVED***
    Object.keys(defaultOpts).forEach(function (key) ***REMOVED***
      if (!options[key]) ***REMOVED***
        options[key] = defaultOpts[key];
      ***REMOVED***
    ***REMOVED***);

    return options;
  ***REMOVED***
***REMOVED***

function cliWidth(options) ***REMOVED***
  var opts = normalizeOpts(options);

  if (opts.output.getWindowSize) ***REMOVED***
    return opts.output.getWindowSize()[0] || opts.defaultWidth;
  ***REMOVED*** else ***REMOVED***
    if (opts.tty.getWindowSize) ***REMOVED***
      return opts.tty.getWindowSize()[1] || opts.defaultWidth;
    ***REMOVED*** else ***REMOVED***
      if (opts.output.columns) ***REMOVED***
        return opts.output.columns;
      ***REMOVED*** else ***REMOVED***
        if (process.env.CLI_WIDTH) ***REMOVED***
          var width = parseInt(process.env.CLI_WIDTH, 10);

          if (!isNaN(width) && width !== 0) ***REMOVED***
            return width;
          ***REMOVED***
        ***REMOVED***
      ***REMOVED***

      return opts.defaultWidth;
    ***REMOVED***
  ***REMOVED***
***REMOVED***;
