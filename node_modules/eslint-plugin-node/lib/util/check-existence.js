/**
 * @author Toru Nagashima
 * See LICENSE file in root directory for full license.
 */
"use strict"

const exists = require("./exists")
const getAllowModules = require("./get-allow-modules")

/**
 * Checks whether or not each requirement target exists.
 *
 * It looks up the target according to the logic of Node.js.
 * See Also: https://nodejs.org/api/modules.html
 *
 * @param ***REMOVED***RuleContext***REMOVED*** context - A context to report.
 * @param ***REMOVED***ImportTarget[]***REMOVED*** targets - A list of target information to check.
 * @returns ***REMOVED***void***REMOVED***
 */
module.exports = function checkForExistence(context, targets) ***REMOVED***
    const allowed = new Set(getAllowModules(context))

    for (const target of targets) ***REMOVED***
        const missingModule =
            target.moduleName != null &&
            !allowed.has(target.moduleName) &&
            target.filePath == null
        const missingFile =
            target.moduleName == null && !exists(target.filePath)

        if (missingModule || missingFile) ***REMOVED***
            context.report(***REMOVED***
                node: target.node,
                loc: target.node.loc,
                message: '"***REMOVED******REMOVED***name***REMOVED******REMOVED***" is not found.',
                data: target,
            ***REMOVED***)
        ***REMOVED***
    ***REMOVED***
***REMOVED***
