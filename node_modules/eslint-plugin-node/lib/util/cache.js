/**
 * @author Toru Nagashima
 * See LICENSE file in root directory for full license.
 */
"use strict"

const SKIP_TIME = 5000

/**
 * The class of cache.
 * The cache will dispose of each value if the value has not been accessed
 * during 5 seconds.
 */
module.exports = class Cache ***REMOVED***
    /**
     * Initialize this cache instance.
     */
    constructor() ***REMOVED***
        this.map = new Map()
    ***REMOVED***

    /**
     * Get the cached value of the given key.
     * @param ***REMOVED***any***REMOVED*** key The key to get.
     * @returns ***REMOVED***any***REMOVED*** The cached value or null.
     */
    get(key) ***REMOVED***
        const entry = this.map.get(key)
        const now = Date.now()

        if (entry) ***REMOVED***
            if (entry.expire > now) ***REMOVED***
                entry.expire = now + SKIP_TIME
                return entry.value
            ***REMOVED***
            this.map.delete(key)
        ***REMOVED***
        return null
    ***REMOVED***

    /**
     * Set the value of the given key.
     * @param ***REMOVED***any***REMOVED*** key The key to set.
     * @param ***REMOVED***any***REMOVED*** value The value to set.
     * @returns ***REMOVED***void***REMOVED***
     */
    set(key, value) ***REMOVED***
        const entry = this.map.get(key)
        const expire = Date.now() + SKIP_TIME

        if (entry) ***REMOVED***
            entry.value = value
            entry.expire = expire
        ***REMOVED*** else ***REMOVED***
            this.map.set(key, ***REMOVED*** value, expire ***REMOVED***)
        ***REMOVED***
    ***REMOVED***
***REMOVED***
