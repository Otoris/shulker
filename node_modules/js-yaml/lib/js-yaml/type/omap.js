'use strict';

var Type = require('../type');

var _hasOwnProperty = Object.prototype.hasOwnProperty;
var _toString       = Object.prototype.toString;

function resolveYamlOmap(data) ***REMOVED***
  if (data === null) return true;

  var objectKeys = [], index, length, pair, pairKey, pairHasKey,
      object = data;

  for (index = 0, length = object.length; index < length; index += 1) ***REMOVED***
    pair = object[index];
    pairHasKey = false;

    if (_toString.call(pair) !== '[object Object]') return false;

    for (pairKey in pair) ***REMOVED***
      if (_hasOwnProperty.call(pair, pairKey)) ***REMOVED***
        if (!pairHasKey) pairHasKey = true;
        else return false;
      ***REMOVED***
    ***REMOVED***

    if (!pairHasKey) return false;

    if (objectKeys.indexOf(pairKey) === -1) objectKeys.push(pairKey);
    else return false;
  ***REMOVED***

  return true;
***REMOVED***

function constructYamlOmap(data) ***REMOVED***
  return data !== null ? data : [];
***REMOVED***

module.exports = new Type('tag:yaml.org,2002:omap', ***REMOVED***
  kind: 'sequence',
  resolve: resolveYamlOmap,
  construct: constructYamlOmap
***REMOVED***);
